syntax = "proto3";

package rat;

service AskForInstructions {
    rpc Send (Beacon) returns (CommandRequest);
}

service RecordCommandResult {
    rpc Send (CommandResponse) returns (Empty);
}

message Beacon {
    int32 last_received = 1;
}

message CommandRequest {
    string command = 1;
}

message CommandResponse {
    string implant_id = 1;
    uint64 timestamp = 2;
    string command = 3;
    string result = 4;
}

message Empty {}